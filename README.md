# 编写一个bootstrap网站项目，在开始前先进行规划我同意后才能开始
### 《大六壬知识科普网站》项目设计文档

**文档版本:** 1.0
**定稿日期:** 2025-06-19

---

python -m http.server

#### **1. 项目概述 (Project Overview)**

本项目旨在设计一个以“大六壬”为主题的知识科普网站。该网站将采用纯粹的客户端技术，实现动态内容加载与交互功能，同时严格遵循不使用任何后端服务器技术（如数据库、Java Servlet等）和前端构建框架（如Vite、Vue）的限制。

网站将完全依赖HTML、CSS和JavaScript构建，所有页面均为静态HTML文件。动态内容的实现将通过JavaScript异步获取本地JSON文件数据并渲染到页面中来完成，从而在无后端的情况下提供丰富的、可更新的用户体验。
**技术架构:**

- **核心语言:** HTML5, CSS3, JavaScript (ES6+)
- **前端库:**
    - **Bootstrap 5:** 用于快速构建响应式布局和UI组件。
    - **Bootstrap Icons:** 提供丰富的图标集。
    - **Masonry:** 用于创建优雅的瀑布流网格布局。
- **数据存储:** 所有可变内容（如神将信息、课例、书籍）将以结构化的 **JSON** 文件形式存储在项目中。
- **内置对象:** 项目将广泛使用JavaScript的内置对象，如 `window`, `document`, `navigator` 用于浏览器交互，`Date`, `Math` 用于排盘计算，以及通过 `fetch` API返回的 `Request`, `Response` 对象等，以满足技术要求。

**最终交付物:** 一套完整的、包含HTML, CSS, JS和数据文件的项目文件夹，可以直接在任何静态服务器或本地通过浏览器打开运行。
#### **2. 视觉风格与设计原则 (Visual Style & Design Principles)**

网站的视觉风格是其灵魂，旨在传达专业、深邃且富有文化底蕴的气质。我们将此风格定义为 **“传统现代水墨风”**。这并非简单地堆砌传统元素，而是将水墨画的艺术精髓与现代网页设计原则相融合。

##### **2.1. 色彩与字体 (Color & Typography)**

*   **主色调:** 调色板将严格遵循水墨画的用色哲学。以 **黑 (`#000000`)、白 (`#FFFFFF`) 及一组精心选择的灰色系** 为主色，营造出素雅、沉静的基调。点缀色将选用低饱和度的 **印章红** 或 **靛蓝**，用于链接、高亮及关键交互元素，起到“画龙点睛”的作用，同时确保符合无障碍对比度标准 [110]。
*   **字体选型:**
    *   **标题字体:** 将采用开源可商用的毛笔书法字体，如 **「正风毛笔字体」** 或 **「玄冬楷书」**。这些字体不仅具有强烈的艺术表现力，且支持通过字体子集化技术进行优化，以保证加载性能 [202][203]。
    *   **正文字体:** 为保证长时间阅读的舒适性和清晰度，正文将采用高质量的黑体或宋体。


##### **2.2. 布局与质感 (Layout & Texture)**

- **布局与质感:**
    - **响应式布局:** 所有页面将基于Bootstrap 5的 **Container** 和 **Grid系统** 进行构建，确保在桌面、平板和手机等不同尺寸的设备上都能获得优良的浏览体验。
    - **背景与纹理:** 页面背景将使用高质量、可平铺的宣纸纹理图片，通过`style.css`中的`background-image`属性实现。
    - **留白:** 页面设计将采用大量留白，突出核心内容，创造“计白当黑”的艺术意境。
- **交互特效:**
    - **CSS动画:** 在 `style.css` 中为按钮、卡片等元素定义鼠标悬停 (`:hover`) 和激活 (`:active`) 状态的过渡动画，如颜色渐变、轻微位移等。
    - **水墨扩散效果:** 关键内容（如卡片加载时）将尝试使用纯CSS的 `mask-image` 或SVG滤镜技术，模拟墨迹扩散或浸润的浮现动画，增加页面的生动感和艺术感。

##### **2.3. 动态视觉效果 (Dynamic Visual Effects)**

我们将通过高级CSS及SVG技术，为网站注入生动、自然的微交互，以模拟水墨的物理特性。

*   **核心技术:**
    *   **CSS遮罩与滤镜:** 卡片的浮现动画将优先采用纯CSS方案。通过对 **`mask-image`** 属性进行动画（如使用PNG序列帧配合`steps()`函数，或对`mask-size`进行动画），模拟墨迹扩散或笔触擦除的浮现效果，此方案比Canvas更轻量且易于维护 [210][207]。
    *   **SVG滤镜:** 对于更高级、更具随机性的水墨效果，我们将利用SVG滤镜。通过组合 **`<feTurbulence>`**（生成自然噪点）和 **`<feDisplacementMap>`**（根据噪点进行像素位移），可以创造出极为逼真的墨迹边缘浸润效果。这些滤镜的参数（如`scale`, `baseFrequency`）可以通过JavaScript进行动态控制，以响应用户的悬停等交互 [311][312][313]。
    *   **Canvas备选方案:** 对于网站的关键视觉区域（如首页Banner），可以考虑使用HTML5 Canvas实现高度交互性的动态水墨背景。通过监听鼠标事件，利用粒子系统算法模拟墨滴的流动、飞溅与浸润，创造出引人入胜的视觉体验 [126][129]。

这些技术的结合，旨在创造一个既有古典美学神韵，又具备现代Web技术流畅交互的独特数字体验。

#### **3. 网站架构与页面规划 (Site Architecture & Page Planning)**


```
/ (项目根目录)
├─ index.html
├─ intro.html
├─ deities.html
├─ cases.html
├─ divination.html
├─ books.html
├─ community.html
├─ data/
│   ├─ deities.json
│   ├─ cases.json
│   └─ books.json
├─ css/
│   ├─ bootstrap-icons.css
│   ├─ bootstrap.min.css
│   └─ style.css
└─ js/
    ├─ bootstrap.min.js
    ├─ masonry.pkgd.min.js
    └─ (其他第三方库, 如lunar.js, suncalc.js等)

```

##### **3.1 首页 (index.html): 大六壬简介**
*   **目的:** 作为网站的门户，快速建立“专业、现代、典雅”的第一印象，并引导用户至各核心板块。
*   **核心组件:**
    *   **轮播图 (Bootstrap Carousel):** 页面顶部将使用全宽轮播图，展示3-4幅精心设计的水墨风格图像，每幅图像配以一句概括性的、引人深思的六壬核心理念文字。
    *   **卡片 (Bootstrap Card):** 轮播图下方将采用卡片式布局，以图文并茂的形式介绍“基础入门”、“神将释义”、“在线排盘”等核心板块，并提供直接链接。卡片在鼠标悬停时将触发水墨扩散浮现动画 [204]。

##### **3.2 基础入门 (intro.html)**
*   **目的:** 系统性地为初学者讲解大六壬的基础概念和起课流程。
*   **内容结构:** 遵循“天地盘 → 四课 → 三传 → 神将”的逻辑顺序进行教学 [72]。内容将大量采用图解和可视化步骤，例如，用双层圆盘SVG动画展示“月将加时”起天地盘的过程 [73]。
*   **核心功能:**
    *   **图文并茂:** 大量使用静态图解，清晰展示四课的“阳神”、“阴神”推导链条 [77]。
    *   **概念模型:** 引入“能量转化模型”、“因缘果模型”等现代比喻，帮助学习者建立对六壬体系的深度理解，避免死记硬背 [72][74]。
    *   **嵌入式视频:** 嵌入预先录制的教学视频，对关键难点（如九宗门取三传）进行动态讲解 [80]。

##### **3.3 神将释义 (deities.html)**
*   **目的:** 提供一个详尽、可查询的十二天将与十二月将的知识库。
*   **核心功能:**
    *   **动态加载:** 页面内容将通过`Fetch API`异步请求`deities.json`文件，然后由JavaScript动态渲染到页面上，实现内容与结构的分离 [154]。
    *   **数据区分:** 严格区分“十二天将”（贵人、螣蛇等，用于占断细节）和“十二月将”（登明、神后等，太阳躔次之神），并分别展示 [21][25]。
    *   **交互式列表/网格:** 使用列表或网格布局展示所有神将。每个神将是一个卡片，包含其图像和核心释义。
    *   **模态框详解 (Bootstrap Modal):** 点击任意神将卡片，将弹出一个模态框，展示该神将的详细信息，包括其五行、吉凶、象征、以及在不同占事中的具体应用 [25][93]。

##### **3.4 经典课例 (cases.html)**
*   **目的:** 通过分析真实案例，展示大六壬在实际预测中的应用方法与惊人准确性。
*   **内容来源:** 精选古代（如邵彦和断案）及现代（如股票预测、风水占断）的经典课例，所有案例数据存储于`cases.json` [54][51][52]。
*   **核心功能:** 每个课例将作为一个独立的内容单元呈现，包含起课时间、课盘结构、详细的逻辑分析过程以及最终的应验结果，为学习者提供完整的“范本式”学习材料。

##### **3.5 在线排盘 (divination.html)**
*   **目的:** 提供一个纯客户端、高精度的在线排盘工具，作为学习和实践的核心辅助。
*   **核心功能:**
    *   **表单输入 (Bootstrap Form):** 提供一个表单，用户可输入公历日期、时间以及地理位置（经纬度）。
    *   **高精度时间计算:**
        *   **基础历法库:** 使用 **`lunar-javascript`** 库进行公历、农历、干支及节气的转换。该库声称采用“寿星天文历”算法，理论上具备高精度，但需通过与紫金山天文台数据比对进行验证 [31][321]。
        *   **真太阳时 (True Solar Time):** 算法的核心。将使用如 **`suncalc`** 或 **`true-solar-time-calculator`** 等专用库，根据用户输入的经纬度和标准时间，计算出“均时差”(EOT)，从而校正得到真太阳时。这是保证排盘（尤其是时柱）准确性的关键步骤 [239][232]。
    *   **客户端排盘算法:**
        1.  **天地盘:** 根据真太阳时对应的时辰，以及当月节气确定的月将，起出天地盘。
        2.  **四课:** 遵循“天干寄宫”法则，从天地盘中发出四课 [16]。
        3.  **三传:** 实现完整的“九宗门”决策树逻辑，根据四课的克贼关系，依次判断贼克、比用、涉害、遥克、昴星、别责、八专等课体，最终取出三传。算法已细化至处理“涉害深度”的三种计算方法及“比用格”等修正机制 [159][164][243]。
        4.  **神煞:** 实现常用神煞的计算，如日德、禄神、驿马、天喜等，其排法将依据《大六壬神煞指南》等权威文献进行校准，并参考现有开源库实现 [167][174]。
    *   **结果展示:** 计算过程完全在Web Worker中执行，避免UI阻塞。计算完成后，结果将以静态的SVG图形或结构化文本的形式动态渲染到页面上，并确保其符合无障碍标准 [154]。

##### **3.6 古籍典藏 (books.html)**
*   **目的:** 整理和介绍大六壬领域的核心经典古籍，为进阶研究者提供指引。
*   **核心功能:**
    *   **动态列表:** 通过加载`books.json`动态生成古籍列表。
    *   **内容呈现:** 每部古籍将配有高清封面、作者、年代、内容提要、历史地位评价以及版本考证信息。将重点介绍《毕法赋》、《大六壬指南》、《大六壬心镜》等核心典籍，并对《御定六壬金口合占》这类结构独特的“合占”类工具书进行专门解读 [82][184]。

##### **3.7 留言交流 (community.html)**
*   **目的:** 提供一个开放的交流平台，供用户提问、分享学习心得。
*   **技术方案修正:** 经研究，原计划的`localStorage`方案因其数据仅存于用户本地浏览器，无法实现公共交流，故**完全摒弃** [41][48]。
*   **最终方案 (Giscus):**
    *   **原理:** 集成 **Giscus**，一个基于 **GitHub Discussions** 的开源、无服务器评论系统。所有留言数据将存储在项目指定的公共GitHub仓库的Discussions板块中，用户通过其GitHub账户进行登录和评论 [227][229]。
    *   **优势:** 此方案完美契合“无后端”的技术约束，同时保证了数据的开放性、可移植性和开发者对数据的完全所有权 [223]。
    *   **交互优化:** 将启用Giscus的懒加载功能 (`data-loading="lazy"`)，并实现与网站整体“水墨风”主题的动态同步切换功能，提供无缝的用户体验 [228]。

#### **4. 核心功能与交互设计 (Core Functionality & Interaction Design)**

本章深入探讨网站动态功能的实现机制，聚焦于数据处理、核心交互和用户体验增强。

##### **4.1 客户端数据处理**

*   **数据获取:** 网站的大部分内容，如神将释义、课例和古籍信息，将存储在静态JSON文件中。前端JavaScript将使用现代的 **`Fetch API`** 异步请求这些本地JSON文件。
    > 示例: `fetch('./data/cases.json').then(response => response.json()).then(data => { renderCases(data); });`
*   **动态渲染:** 获取数据后，将通过标准的 **DOM操作** (例如 `document.createElement`, `element.appendChild`, `element.textContent`) 将数据动态地渲染成HTML元素。为避免性能问题，对于列表等大量DOM操作，将采用 `DocumentFragment` 进行批处理，一次性插入到页面中，以减少浏览器的回流(reflow)和重绘(repaint) [152]。
*   **性能考量:** 对于大型JSON文件，将探索使用 **Web Worker** 在后台线程进行解析，以防主线程被长时间阻塞，确保UI的流畅响应 [154]。

##### **4.2 在线排盘交互**

“在线排盘”工具是网站的核心交互功能，其用户流程设计如下：
1.  **输入:** 用户在表单中输入公历年月日时，并通过地图组件或手动输入提供经纬度。
2.  **验证:** JavaScript对输入数据进行客户端验证，确保格式正确。
3.  **计算委托:** 主线程将验证后的时间与地理位置数据通过 `postMessage` 发送给一个专门的 **Web Worker**。
4.  **后台运算:** Web Worker接收数据，并依次执行：
    *   调用真太阳时计算模块，获得精确的占课时间。
    *   调用`lunar-javascript`库，获取对应的干支和节气信息。
    *   执行完整的大六壬排盘算法，生成天地盘、四课、三传及神煞等结构化数据。
5.  **结果返回:** Web Worker将计算完成的课盘数据对象通过 `postMessage` 返回给主线程。
6.  **动态生成:** 主线程监听到消息后，接收数据并调用渲染函数，将课盘以高度可访问的SVG图形或结构化文本的形式动态呈现在页面上。整个过程用户界面保持完全可交互状态。

##### **4.3 留言表单交互 (Giscus)**

*   **实现逻辑:**
    1.  在“留言交流”页面嵌入Giscus提供的`<script>`代码片段。
    2.  该脚本会自动在指定的挂载点渲染一个`iframe`，其中包含了完整的评论UI和逻辑。
    3.  用户通过点击“使用GitHub登录”按钮，完成OAuth授权流程。
    4.  用户提交的评论将通过Giscus的后端服务，最终以帖子的形式发布到项目指定的GitHub仓库的Discussions板块中。
*   **动态主题切换:** 网站的明暗模式切换功能将通过`postMessage`与Giscus的iframe通信，实时更新评论区的主题，确保视觉风格的统一 [225]。

##### **4.4 微交互与动效 (Micro-interactions & Animations)**

全局性的微交互设计旨在增强用户操作的即时反馈和视觉趣味性。
*   **导航栏 (Navbar):** 当前激活的页面链接将有明确的视觉状态（如下划线或颜色变化）。
*   **按钮 (Button):** 按钮在悬停和点击时，将有清晰的视觉反馈。
*   **卡片浮现动画:** 列表中的卡片元素在进入视口时，将触发基于CSS `mask-image` 或SVG滤镜的水墨扩散浮现动画，增加页面的生动感。动画的实现将严格遵守 **`prefers-reduced-motion`** 媒体查询，为希望减少动态效果的用户提供平滑的降级体验（如简单的淡入效果）[212]。

#### **5. 技术选型与组件应用 (Technology Stack & Component Application)**

本章将项目需求与具体技术工具进行精确映射，确保每一项技术选型都有明确的实施路径和优化策略。

##### **5.3 JavaScript (ES6+) 核心任务**

*   **数据获取与渲染:** 通过`Fetch API`实现对本地JSON文件的异步请求，并通过原生DOM API实现内容的动态渲染。
*   **算法实现:** 编写并实现高精度的大六壬排盘算法，包括真太阳时校正和九宗门逻辑。
*   **交互逻辑:** 为所有UI组件（模态框、导航、动态效果）编写事件处理和交互逻辑。
*   **无障碍支持:** 实现复杂的无障碍功能，如模态框的焦点陷阱、复杂SVG图表的键盘导航等。

##### **5.4 性能优化策略**

*   **字体子集化:** 对于选定的书法字体，将使用`font-subset`等工具，采用基于`unicode-range`的 **字体切片方案**。这将整个字体库分割成多个微小片段，浏览器仅下载渲染当前页面所需字符的片段，极大优化了中文字体的加载性能和LCP（最大内容绘制）指标 [197][200]。
*   **资源懒加载:** 对非首屏的图片使用`loading="lazy"`属性。对于Giscus评论区等重型`iframe`，启用其内置的懒加载功能。
*   **Service Worker 缓存:** 部署Service Worker，对静态资源（JS, CSS, 字体, 图片）采用 **“缓存优先 (Cache First)”** 策略，对动态的JSON数据采用 **“后台更新时重新验证 (Stale-While-Revalidate)”** 策略，以实现快速的二次访问和基本的离线能力 [147]。

##### **5.5 无障碍设计 (Accessibility, A11y)**

无障碍设计是本项目的核心原则之一，旨在确保所有用户，无论其能力如何，都能平等地访问网站内容。

*   **色彩与对比度:**
    *   严格遵循WCAG 2.1 AA级标准，确保所有文本与背景的对比度至少为 **4.5:1**（大文本为3:1）。将使用专业工具进行校验。
    *   在“水墨风”设计中，对于对比度不足的灰色调UI元素（如按钮），将采用增加高对比度 **`border`** 的方式来明确其轮廓，这是W3C认可的合规技术 [110][119]。
*   **键盘导航与焦点管理:**
    *   **焦点可见性:** 确保所有可交互元素都有清晰、高对比度的焦点指示器（`:focus-visible`）。焦点样式将采用`outline`属性，以保证在Windows高对比度模式下的可用性 [254][131]。
    *   **焦点陷阱 (Focus Trap):** 对于模态框（Modal）等覆盖式UI，将实现焦点陷阱，确保用户在使用键盘导航时焦点不会逃逸到模态框之外。将优先考虑使用成熟的第三方库如`focus-trap`或利用HTML5 `<dialog>`元素的原生行为 [100][103]。
    *   **复杂SVG导航 (在线排盘):** 这是无障碍设计的最大挑战。我们将采用 **“漫游TabIndex (Roving Tabindex)”** 或 **`aria-activedescendant`** 模式，结合JavaScript事件监听，为“在线排盘”的SVG图表实现逻辑化的键盘导航序列（天地盘 → 四课 → 三传）。同时，通过`aria-label`和`aria-describedby`为非视觉用户提供清晰的组件描述和操作指南 [258][265]。
*   **语义化HTML与ARIA:**
    *   所有页面都将使用语义化的HTML5标签（`<main>`, `<nav>`, `<article>`, `<section>`等）。
    *   对于通过JavaScript动态加载和更新的内容区域，将使用 **ARIA Live Regions** (`role="status"`, `aria-live="polite"`)，以便向屏幕阅读器用户宣告内容变化 [66]。
*   **高对比度模式 (HCM) 兼容性:**
    *   通过 **`forced-colors: active`** 媒体查询，为Windows高对比度模式提供专属样式。
    *   对于重要的SVG图形（如排盘），其内部元素的`fill`和`stroke`属性将设置为 **`currentColor`**，并在CSS中通过系统颜色关键词（如`ButtonText`, `HighlightText`）进行控制，确保其在任何HCM主题下都清晰可见 [131][136]。
